<!DOCTYPE html>
<html lang="es" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Invtc Sucre 2</title>
    <link
      rel="icon"
      href="https://i.ibb.co/PZhMy4bD/123.png"
      type="image/png"
    />
    <link rel="stylesheet" href="/css/scr.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
  </head>
  <body>
    <aside class="sidebar">
      <button id="btnDiplomado" class="nav-btn active" data-tooltip="Diplomado">
        <span class="material-icons">school</span>
      </button>
      <button id="btnMaestria" class="nav-btn" data-tooltip="MaestrÃ­a">
        <span class="material-icons">auto_stories</span>
      </button>
      <a href="/err/404.html">
        <button id="btn" class="nav-btn" data-tooltip="Ir a Drive">
          <span class="material-icons">drive_folder_upload</span>
        </button>
      </a>

      <div class="sidebar-logo">
        <img
          src="https://www.esam.edu.bo/img/logo_esam_principal.png"
          alt="Logo ESAM"
          style="width: 48px; height: 48px; object-fit: contain"
        />
      </div>
    </aside>

    <button class="theme-toggle" id="themeToggle">
      <span class="material-icons">dark_mode</span>
    </button>

    <main>
      <div class="frame-container">
        <div class="loading-overlay">
          <div class="loader">
            <div class="loader-circle"></div>
            <div class="loader-particles">
              <div
                class="loader-particle"
                style="left: 15%; animation-delay: 0.1s"
              ></div>
              <div
                class="loader-particle"
                style="left: 30%; animation-delay: 0.3s"
              ></div>
              <div
                class="loader-particle"
                style="left: 45%; animation-delay: 0.5s"
              ></div>
              <div
                class="loader-particle"
                style="left: 60%; animation-delay: 0.7s"
              ></div>
              <div
                class="loader-particle"
                style="left: 75%; animation-delay: 0.9s"
              ></div>
            </div>
            <svg
              class="checkmark"
              viewBox="0 0 24 24"
              fill="none"
              stroke="var(--loader-primary)"
              stroke-width="2"
            >
              <path
                d="M20 6L9 17l-5-5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </div>
        </div>
        <iframe
          id="sheetFrame"
          src="https://docs.google.com/spreadsheets/d/1HBgccBnUsVuS1Cj41uefAbynjbyl6RpetMvBOoPM_u4/edit?rm=minimal"
          allowfullscreen
        ></iframe>
      </div>
    </main>

    <div class="access-message">
      <div class="message-icon-container">
        <div class="message-icon">
          <span class="material-icons">warning</span>
        </div>
      </div>
      <h2 class="message-title">Eee no puedes ingresarðŸ™ƒ</h2>
      <div class="message-content">
        Para acceder a este documento necesitas permisos de ediciÃ³n. Por favor
        contacta al administrador del sistema para solicitar acceso.
      </div>
      <div class="message-contact">
        <a href="mailto:efrain.chiri@esam.edu.bo" class="contact-link">
          <span class="material-icons">alternate_email</span>
          efrain.chiri@esam.edu.bo
        </a>
      </div>
    </div>
    <script>
      // Sistema de temas
      const themeToggle = document.getElementById("themeToggle");
      const body = document.body;
      const currentTheme = localStorage.getItem("theme");

      if (currentTheme) {
        body.setAttribute("data-theme", currentTheme);
        updateThemeIcon();
      }

      themeToggle.addEventListener("click", () => {
        const isDark = body.getAttribute("data-theme") === "dark";
        body.setAttribute("data-theme", isDark ? "light" : "dark");
        localStorage.setItem("theme", isDark ? "light" : "dark");
        updateThemeIcon();
      });

      function updateThemeIcon() {
        const isDark = body.getAttribute("data-theme") === "dark";
        themeToggle.innerHTML = isDark
          ? '<span class="material-icons">dark_mode</span>'
          : '<span class="material-icons">light_mode</span>';
      }

      // URLs predefinidas
      const URLs = {
        Diplomado:
          "https://docs.google.com/spreadsheets/d/1_ROc5M-xCHm-oXI75HhuGyhurYKXGTsMF-ZU_f31YKY/edit?rm=embedded",
        maestria:
          "https://docs.google.com/spreadsheets/d/1TtjFiNVjeayXq8nkl9DXsiPN5sfaIHGBgIIKwHTL4NY/edit?rm=embedded",
      };

      // Elementos del DOM
      const frame = document.getElementById("sheetFrame");
      const buttons = document.querySelectorAll(".nav-btn");
      const loadingOverlay = document.querySelector(".loading-overlay");

      // Precargar los iframes
      const preloadFrame = (url) => {
        const hiddenFrame = document.createElement("iframe");
        hiddenFrame.style.display = "none";
        hiddenFrame.src = url;
        document.body.appendChild(hiddenFrame);
      };

      // Precargar todos los frames al iniciar
      Object.values(URLs).forEach(preloadFrame);

      // FunciÃ³n optimizada para cambiar de hoja
      async function switchSheet(type) {
        // Actualizar botones inmediatamente
        buttons.forEach((btn) => {
          const targetType = `btn${
            type.charAt(0).toUpperCase() + type.slice(1)
          }`;
          btn.classList.toggle("active", btn.id === targetType);
        });

        // Mostrar loader y ocultar frame
        loadingOverlay.classList.add("active");
        frame.style.opacity = "0";

        try {
          // Cargar el frame con timeout de 5 segundos
          await Promise.race([
            new Promise((resolve) => {
              frame.src = URLs[type];
              frame.onload = resolve;
            }),
            new Promise((_, reject) =>
              setTimeout(() => reject(new Error("Timeout")), 1000)
            ),
          ]);
        } catch (error) {
          console.error("Error loading frame:", error);
        } finally {
          // Ocultar loader y mostrar frame
          loadingOverlay.classList.remove("active", "loaded");
          frame.style.opacity = "1";
        }
      }

      // Event listeners optimizados
      buttons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const type = btn.id.replace("btn", "").toLowerCase();
          if (type && URLs[type]) switchSheet(type);
        });
      });

      // Carga inicial inmediata
      frame.src = URLs.Diplomado;
    </script>
  </body>
</html>
